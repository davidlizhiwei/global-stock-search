<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å…¨çƒè‚¡å¸‚æŸ¥è¯¢ - Global Stock Search</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
            min-height: 100vh; padding: 20px;
        }
        .container { max-width: 900px; margin: 0 auto; }
        header { text-align: center; padding: 40px 0; color: #ffffff; }
        header h1 {
            font-size: 2.5rem; margin-bottom: 10px;
            background: linear-gradient(90deg, #00d9ff, #00ff88);
            -webkit-background-clip: text; -webkit-text-fill-color: transparent;
        }
        header p { color: #a0a0a0; font-size: 1rem; }
        .search-box {
            background: rgba(255,255,255,0.1); border-radius: 20px; padding: 30px;
            margin-bottom: 30px; border: 1px solid rgba(255,255,255,0.1);
        }
        .search-input-wrapper { display: flex; gap: 10px; }
        .search-input-wrapper input {
            flex: 1; padding: 15px 20px; font-size: 16px;
            border: 2px solid rgba(255,255,255,0.2); border-radius: 12px;
            background: rgba(255,255,255,0.05); color: #fff; outline: none;
        }
        .search-input-wrapper input:focus { border-color: #00d9ff; }
        .search-input-wrapper input::placeholder { color: #888; }
        .search-input-wrapper button {
            padding: 15px 30px; font-size: 16px; font-weight: 600; border: none;
            border-radius: 12px; background: linear-gradient(135deg, #00d9ff, #00ff88);
            color: #1a1a2e; cursor: pointer;
        }
        .search-input-wrapper button:hover { transform: translateY(-2px); }
        .search-input-wrapper button:disabled { opacity: 0.5; cursor: not-allowed; }
        .quick-search { display: flex; flex-wrap: wrap; gap: 8px; margin-top: 15px; }
        .quick-search button {
            padding: 8px 16px; font-size: 13px;
            border: 1px solid rgba(255,255,255,0.2); border-radius: 20px;
            background: rgba(255,255,255,0.05); color: #a0a0a0; cursor: pointer;
        }
        .quick-search button:hover { background: rgba(0,217,255,0.2); border-color: #00d9ff; color: #fff; }
        .result-box {
            background: rgba(255,255,255,0.1); border-radius: 20px; padding: 30px;
            border: 1px solid rgba(255,255,255,0.1); display: none;
        }
        .result-box.show { display: block; animation: fadeIn 0.5s; }
        @keyframes fadeIn { from { opacity:0; transform:translateY(20px); } to { opacity:1; transform:translateY(0); } }
        .loading { text-align: center; padding: 40px; color: #a0a0a0; display: none; }
        .loading.show { display: block; }
        .loading .spinner {
            width: 40px; height: 40px; border: 3px solid rgba(255,255,255,0.1);
            border-top-color: #00d9ff; border-radius: 50%;
            animation: spin 1s linear infinite; margin: 0 auto 15px;
        }
        @keyframes spin { to { transform: rotate(360deg); } }
        .error {
            background: rgba(255,71,87,0.1); border: 1px solid rgba(255,71,87,0.3);
            border-radius: 12px; padding: 20px; text-align: center; color: #ff4757; display: none;
        }
        .error.show { display: block; }
        .chart-container { width: 100%; height: 500px; border-radius: 12px; overflow: hidden; }
        .stock-info { color: #fff; margin-bottom: 20px; }
        .stock-info h3 { font-size: 1.5rem; margin-bottom: 5px; }
        .stock-info .symbol { color: #00d9ff; font-size: 1rem; }
        footer { text-align: center; padding: 40px 0; color: #666; font-size: 0.85rem; }
        footer a { color: #00d9ff; text-decoration: none; }
        @media (max-width: 600px) {
            header h1 { font-size: 1.8rem; }
            .search-input-wrapper { flex-direction: column; }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>ğŸ“ˆ å…¨çƒè‚¡å¸‚æŸ¥è¯¢</h1>
            <p>Global Stock Search - å®æ—¶è‚¡ä»·æŸ¥è¯¢</p>
        </header>

        <div class="search-box">
            <div class="search-input-wrapper">
                <input type="text" id="searchInput" placeholder="è¾“å…¥è‚¡ç¥¨ä»£ç  (å¦‚ï¼šAAPL, TSLA, 0700.HK)" autocomplete="off">
                <button id="searchBtn" onclick="searchStock()">æœç´¢</button>
            </div>
            <div class="quick-search">
                <button onclick="quickSearch('AAPL')">ğŸ‡ºğŸ‡¸ è‹¹æœ</button>
                <button onclick="quickSearch('GOOGL')">ğŸ‡ºğŸ‡¸ è°·æ­Œ</button>
                <button onclick="quickSearch('MSFT')">ğŸ‡ºğŸ‡¸ å¾®è½¯</button>
                <button onclick="quickSearch('TSLA')">ğŸ‡ºğŸ‡¸ ç‰¹æ–¯æ‹‰</button>
                <button onclick="quickSearch('NVDA')">ğŸ‡ºğŸ‡¸ è‹±ä¼Ÿè¾¾</button>
                <button onclick="quickSearch('0700.HK')">ğŸ‡­ğŸ‡° è…¾è®¯</button>
                <button onclick="quickSearch('9988.HK')">ğŸ‡­ğŸ‡° é˜¿é‡Œ</button>
                <button onclick="quickSearch('^GSPC')">æ ‡æ™® 500</button>
                <button onclick="quickSearch('^DJI')">é“ç¼æ–¯</button>
                <button onclick="quickSearch('^IXIC')">çº³æ–¯è¾¾å…‹</button>
            </div>
        </div>

        <div class="loading" id="loading">
            <div class="spinner"></div>
            <p>æ­£åœ¨åŠ è½½å®æ—¶æ•°æ®...</p>
        </div>

        <div class="error" id="error"></div>

        <div class="result-box" id="resultBox">
            <div class="stock-info">
                <h3 id="stockName">-</h3>
                <span class="symbol" id="stockSymbol">-</span>
            </div>
            <div class="chart-container" id="chartContainer"></div>
        </div>

        <footer>
            <p>æ•°æ®æ¥æºï¼šTradingView Â· å®æ—¶è¡Œæƒ…</p>
            <p>Â© 2026 å…¨çƒè‚¡å¸‚æŸ¥è¯¢ | <a href="https://github.com/davidlizhiwei/global-stock-search" target="_blank">GitHub</a></p>
        </footer>
    </div>

    <script>
        let widget = null;

        document.getElementById('searchInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') searchStock();
        });

        function quickSearch(symbol) {
            document.getElementById('searchInput').value = symbol;
            searchStock();
        }

        function parseSymbol(query) {
            query = query.toUpperCase().trim();
            if (query.includes('.HK')) {
                return { symbol: query.replace('.HK', ''), exchange: 'HKEX', name: 'æ¸¯è‚¡' };
            } else if (query.startsWith('^')) {
                const indices = { '^GSPC': 'SPX', '^DJI': 'DJI', '^IXIC': 'IXIC' };
                return { symbol: indices[query] || query, exchange: 'INDEX', name: 'æŒ‡æ•°' };
            } else {
                const nasdaq = ['AAPL','GOOGL','MSFT','TSLA','NVDA','AMZN','META','NFLX','INTC','AMD'];
                return {
                    symbol: query,
                    exchange: nasdaq.includes(query) ? 'NASDAQ' : 'NYSE',
                    name: 'ç¾è‚¡'
                };
            }
        }

        function searchStock() {
            const query = document.getElementById('searchInput').value.trim();
            if (!query) { showError('è¯·è¾“å…¥è‚¡ç¥¨ä»£ç '); return; }

            document.getElementById('loading').classList.add('show');
            document.getElementById('searchBtn').disabled = true;
            document.getElementById('error').classList.remove('show');
            document.getElementById('resultBox').classList.remove('show');

            const parsed = parseSymbol(query);
            const fullSymbol = `${parsed.exchange}:${parsed.symbol}`;

            // æ¸…é™¤æ—§å›¾è¡¨
            document.getElementById('chartContainer').innerHTML = '';

            // åŠ è½½ TradingView è„šæœ¬
            if (typeof TradingView === 'undefined') {
                const script = document.createElement('script');
                script.src = 'https://s3.tradingview.com/tv.js';
                script.onload = () => createWidget(fullSymbol, parsed);
                script.onerror = () => showError('TradingView åŠ è½½å¤±è´¥ï¼Œè¯·åˆ·æ–°é¡µé¢é‡è¯•');
                document.head.appendChild(script);
            } else {
                createWidget(fullSymbol, parsed);
            }
        }

        function createWidget(symbol, parsed) {
            try {
                widget = new TradingView.widget({
                    "autosize": true,
                    "symbol": symbol,
                    "interval": "D",
                    "timezone": "Asia/Shanghai",
                    "theme": "dark",
                    "style": "1",
                    "locale": "zh_CN",
                    "toolbar_bg": "#1a1a2e",
                    "enable_publishing": false,
                    "allow_symbol_change": true,
                    "container_id": "chartContainer",
                    "hide_side_toolbar": false,
                    "details": true,
                    "hotlist": true,
                    "calendar": true,
                    "studies": ["RSI@tv-basicstudies", "MACD@tv-basicstudies"]
                });

                setTimeout(() => {
                    document.getElementById('loading').classList.remove('show');
                    document.getElementById('searchBtn').disabled = false;
                    document.getElementById('resultBox').classList.add('show');
                    document.getElementById('stockName').textContent = `${parsed.symbol} (${parsed.name})`;
                    document.getElementById('stockSymbol').textContent = `${parsed.exchange} Â· TradingView å®æ—¶æ•°æ®`;
                }, 2000);

            } catch (e) {
                showError('å›¾è¡¨åŠ è½½å¤±è´¥ï¼š' + e.message);
                document.getElementById('loading').classList.remove('show');
                document.getElementById('searchBtn').disabled = false;
            }
        }

        function showError(msg) {
            document.getElementById('error').textContent = 'âŒ ' + msg;
            document.getElementById('error').classList.add('show');
            document.getElementById('loading').classList.remove('show');
            document.getElementById('searchBtn').disabled = false;
        }
    </script>
</body>
</html>
